(function(){var i,l,b,j,g,a,k,d,h,e,f={}.hasOwnProperty,c=function(p,n){for(var m in n){if(f.call(n,m)){p[m]=n[m]}}function o(){this.constructor=p}o.prototype=n.prototype;p.prototype=new o();p.__super__=n.prototype;return p};e=(function(){function m(n,o){if(n==null){n=0}if(o==null){o=0}this.set(n,o)}m.prototype.set=function(n,o){if(n==null){n=0}if(o==null){o=0}this.x=n;this.y=o;return this};m.prototype.add=function(n){this.x+=n.x;this.y+=n.y;return this};m.prototype.sub=function(n){this.x-=n.x;this.y-=n.y;return this};m.prototype.scale=function(o){this.x*=o;this.y*=o;return this};m.prototype.div=function(o){this.x/=o;this.y/=o;return this};m.prototype.product=function(n){return this.x*n.x+this.y*n.y};m.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};m.prototype.resize=function(o){if(this.length()){this.scale(o/this.length())}return this};m.prototype.normalize=function(){return this.resize(1)};m.prototype.angle=function(){return(180*Math.atan2(this.y,this.x))/Math.PI};m.prototype.rotate=function(q){var o,p,n,r;o=(q*Math.PI)/180;p=this.length();n=this.x;r=this.y;this.x=Math.sin(o)*r+Math.cos(o)*n;this.y=Math.cos(o)*r-Math.sin(o)*n;return this.resize(p)};m.prototype.clone=function(){return new m(this.x,this.y)};m.prototype.reverse=function(){this.x*=-1;this.y*=-1;return this};m.prototype.max=function(n){if(this.length()<=n){return this}return this.resize(n)};m.prototype.min=function(n){if(this.length()>=n){return this}return this.resize(n)};m.prototype.isZero=function(){return this.x===0&&this.y===0};return m})();Array.prototype._index=function(m){var n;if(m<0){n=this.length;return n+m}return m};Array.prototype.at=function(m){return this[this._index(m)]};Array.prototype.map=function(m){var o,n;return([].splice.apply(this,[0,this.length-0].concat(n=(function(){var r,q,p;p=[];for(r=0,q=this.length;r<q;r++){o=this[r];p.push(m(o))}return p}).call(this))),n)};Array.prototype.clone=function(){return this.dup()};Array.prototype.dup=function(){return this.slice(0,this.length)};Array.prototype.each=function(n){var m,p,o;for(m=p=0,o=this.length;0<=o?p<o:p>o;m=0<=o?++p:--p){n(this[m],m)}return this};Array.prototype.deleteAt=function(m){m=this._index(m);if(m>=this.length){return void 0}return this.splice(m,1)};Array.prototype.deleteIf=function(n){var m;return this.replace((function(){var q,p,o;o=[];for(m=q=0,p=this.length;0<=p?q<p:q>p;m=0<=p?++q:--q){if(!n(this[m],m)){o.push(this[m])}}return o}).call(this))};Array.prototype.reject=function(m){var n;n=this.length;this.deleteIf(m);if(n===this.length){return void 0}return this};Array.prototype.isEmpty=function(){return this.length===0};Array.prototype.isEql=function(m,q){var n,p,o;if(q==null){q=function(s,r){return s===r}}if(this.length!==m.length){return false}for(n=p=0,o=this.length;0<=o?p<o:p>o;n=0<=o?++p:--p){if(!q(this[n],m[n])){return false}}return true};Array.prototype.fill=function(p,q,m){var n,o;if(q==null){q=0}if(m==null){m=this.length-1}q=this._index(q);m=this._index(m);[].splice.apply(this,[q,m-q+1].concat(o=(function(){var s,r;r=[];for(n=s=q;q<=m?s<=m:s>=m;n=q<=m?++s:--s){r.push(p)}return r})())),o;return this};Array.prototype.first=function(){return this[0]};Array.prototype.last=function(){var m;m=this._index(-1);return this[m]};Array.prototype.uniq=function(q){var p,o,n,m;if(q==null){q=function(s,r){return s===r}}p=[];for(n=0,m=this.length;n<m;n++){o=this[n];if(!p.isInclude(o,q)){p.push(o)}}return this.replace(p)};Array.prototype.index=function(p,q){var m,o,n;if(q==null){q=function(s,r){return s===r}}for(m=o=0,n=this.length;0<=n?o<n:o>n;m=0<=n?++o:--o){if(q(this[m],p)){return m}}return void 0};Array.prototype.indexes=function(){var o,p,n,m;m=[];for(p=0,n=arguments.length;p<n;p++){o=arguments[p];m.push(this.at(o))}return m};Array.prototype.rindex=function(p,q){var m,o,n;if(q==null){q=function(s,r){return s===r}}for(m=o=n=this.length;n<=0?o<0:o>0;m=n<=0?++o:--o){if(q(this[m],p)){return m}}return void 0};Array.prototype.flatten=function(){return this.replace(this.reduce(function(n,m){return n.concat(m instanceof Array?m.flatten():m)},[]))};Array.prototype.transpose=function(){var q,p,o,n,m,u,s,r;n=this.isEmpty()?0:this.length;q=this.first() instanceof Array?this.first().length:0;if(!n||!q){return this}o=(function(){var v,t;t=[];for(p=v=0;0<=q?v<q:v>q;p=0<=q?++v:--v){t.push([])}return t})();for(m=s=0;0<=n?s<n:s>n;m=0<=n?++s:--s){for(u=r=0;0<=q?r<q:r>q;u=0<=q?++r:--r){o[u][m]=this[m][u]}}return this.replace(o)};Array.prototype.compact=function(){return this.deleteIf(function(m){return m===void 0})};Array.prototype.isInclude=function(p,q){var n,o,m;if(q==null){q=function(s,r){return s===r}}for(o=0,m=this.length;o<m;o++){n=this[o];if(q(n,p)){return true}}return false};Array.prototype.size=function(){return this.length};Array.prototype.swap=function(n,m){var o;n=this._index(n);m=this._index(m);o=this[n];this[n]=this[m];this[m]=o;return this};Array.prototype.shuffle=function(){var m,o,n;for(m=o=0,n=this.length;0<=n?o<n:o>n;m=0<=n?++o:--o){this.swap(m,Math.floor(Math.random()*this.length))}return this};Array.prototype.choice=function(){return this[Math.floor(Math.random()*this.length)]};Array.prototype.count=function(q,r){var m,n,p,o;if(r==null){r=function(t,s){return t===s}}n=0;for(m=p=0,o=this.length;0<=o?p<o:p>o;m=0<=o?++p:--p){if(r(this[m],q)){++n}}return n};Array.prototype.replace=function(m){var o,p,n;this.clear();for(p=0,n=m.length;p<n;p++){o=m[p];this.push(o)}return this};Array.prototype.nitems=function(){return this.clone().compact().size()};Array.prototype.insert=function(){var o,p,n,m,r,q;o=Array.prototype.slice.call(arguments,0,arguments.length);if(o.size()<=1){return this}n=this._index(o[0]);m=o.slice(1,this.length);for(p=r=0,q=m.length;0<=q?r<q:r>q;p=0<=q?++r:--r){this.splice(n+p,0,m[p])}return this};Array.prototype.clear=function(){var m;m=[];while(!this.isEmpty()){m.push(this.deleteAt(0))}return m};Array.prototype.max=function(n){var m;if(n==null){n=function(p,o){if(p===o){return 0}if(p<o){return -1}else{return 1}}}m=this.first();this.reduce(function(p,o){if(n(m,o)<0){return m=o}});return m};Array.prototype.min=function(n){var m;if(n==null){n=function(p,o){if(p===o){return 0}if(p<o){return -1}else{return 1}}}m=this.first();this.reduce(function(p,o){if(n(m,o)>=0){return m=o}});return m};h=(function(){function m(n,p,r,q,o){if(p==null){p=false}if(r==null){r=0}if(q==null){q=false}if(o==null){o=void 0}this.set(n);this._time=r;this._active=q;this._complete=o;this._repeat=p}m.prototype.set=function(n){if(n==null){n=0}this._max=n;return this};m.prototype.play=function(){this._active=true;return this};m.prototype.stop=function(){this._active=false;this._time=0;return this};m.prototype.pause=function(){this._active=false;return this};m.prototype.reset=function(){this._time=0;return this};m.prototype.tick=function(){if(this._time<this._max&&this._active){++this._time;if(this._time===this._max){if(this._complete!=null){this._complete()}if(this._repeat){this._time=0}}}return this};m.prototype.now=function(){return this._time};m.prototype.max=function(){return this._max};m.prototype.setNow=function(n){this._time=n;return this};m.prototype.setComplete=function(n){this._complete=n;return this};m.prototype.setRepeat=function(n){this._repeat=n;return this};m.prototype.isActive=function(){return this._active};m.prototype.isOver=function(){return this._time>=this._max};return m})();l=(function(){function m(){}m._sounds=[];m.root="";m.load=function(){var r,n,q,p,o;n=Array.prototype.slice.call(arguments);o=[];for(q=0,p=n.length;q<p;q++){r=n[q];o.push(m._loadSound(r))}return o};m.play=function(n){if(!(m._sounds[n]!=null)){m._loadSound(n)}m.stop(n);return m._sounds[n].play()};m.pause=function(n){if(n!=null){return m._sounds[n].pause()}};m.stop=function(n){if(n!=null){return m._sounds[n].stop()}};m._loadSound=function(o,n){if(!(m._sounds[o]!=null)){if(n!=null){return m._sounds[o]=Sound.load(""+m.root+o,n)}else{return m._sounds[o]=Sound.load(""+m.root+o)}}};return m})();enchant();j=(function(n){c(m,n);m.prototype.config={WIDTH:640,HEIGHT:480,FPS:30,FONT:"Helvetica",IMAGE_PATH:"/image/",IMAGES:["kawaz.png","chips/grass.png"],SOUND_PATH:"/sound/",SOUNDS:[],INITIAL_LEVEL:1,LAST_LEVEL:7,LEVEL_TIME:30};function m(){var s,p,r,o,q;m.__super__.constructor.call(this,this.config.WIDTH,this.config.HEIGHT);this.fps=this.config.FPS;this.keybind(90,"a");this.keybind(88,"b");m.game=this;m.config=this.config;q=this.config.IMAGES;for(r=0,o=q.length;r<o;r++){s=q[r];this.preload(""+this.config.IMAGE_PATH+s)}p=new b();this.onload=function(){p.setup();return this.pushScene(p)};this.start()}return m})(Game);window.onload=function(){return new j()};i=(function(m){c(n,m);function n(p,q,o,r){if(o==null){o=0}if(r==null){r=0}n.__super__.constructor.call(this,p,q);this.removeEventListener("enterframe");this.x=o;this.y=r;this.v=new e();this.speed=7}n.prototype.update=function(o){this.x+=this.v.x;return this.y+=this.v.y};n.prototype.setImage=function(o){return this.image=j.game.assets[""+j.config.IMAGE_PATH+o]};n.prototype.position=function(){return new e(this.x,this.y)};n.prototype.center=function(){return new e(this.x+this.width/2,this.y+this.height/2)};return n})(Sprite);d={None:0,Floor:1,Wall:2};k=(function(n){c(m,n);function m(){m.__super__.constructor.call(this,48,48);this.setImage("chips/grass.png")}return m})(i);a=(function(n){c(m,n);function m(){var q,o,s,r,p;m.__super__.constructor.apply(this,arguments);for(o=r=0;r<10;o=++r){for(s=p=0;p<10;s=++p){q=new k();q.x=o*48;q.y=s*48;this.addChild(q)}}}return m})(Group);g=(function(n){c(m,n);function m(){m.__super__.constructor.apply(this,arguments);this.stage=new a();this.addChild(this.stage)}m.prototype.setup=function(){return this};m.prototype.update=function(){return console.log("hoge")};return m})(Scene);b=(function(n){c(m,n);function m(){return m.__super__.constructor.apply(this,arguments)}m.prototype.setup=function(){this.kawaz=new i(253,81);this.kawaz.setImage("kawaz.png");this.kawaz.x=193.5;this.kawaz.y=220;this.kawaz.opacity=0;this.addChild(this.kawaz);this.addEventListener("enterframe",this.update);this.timer=new h(180);this.timer.setComplete(function(){j.game.replaceScene(new g());return this});return this.timer.play()};m.prototype.update=function(){if(j.game.input.a){j.game.replaceScene(new g());this}this.timer.tick();if(this.timer.now()<60){return this.kawaz.opacity+=1/60}else{if(this.timer.now()>120){return this.kawaz.opacity-=1/60}}};return m})(Scene)}).call(this);